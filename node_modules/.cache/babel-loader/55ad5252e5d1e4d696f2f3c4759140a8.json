{"ast":null,"code":"function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n\n  _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nvar _require = require('preact'),\n    h = _require.h,\n    Component = _require.Component;\n\nvar classNames = require('classnames');\n\nvar getFileTypeIcon = require('../../utils/getFileTypeIcon');\n\nvar ignoreEvent = require('../../utils/ignoreEvent.js');\n\nvar FilePreview = require('../FilePreview');\n\nvar FileCard = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(FileCard, _Component);\n\n  function FileCard(props) {\n    var _this;\n\n    _this = _Component.call(this, props) || this;\n\n    _this.updateMeta = function (newVal, name) {\n      var _extends2;\n\n      _this.setState({\n        formState: _extends({}, _this.state.formState, (_extends2 = {}, _extends2[name] = newVal, _extends2))\n      });\n    };\n\n    _this.handleSave = function (e) {\n      e.preventDefault();\n      var fileID = _this.props.fileCardFor;\n\n      _this.props.saveFileCard(_this.state.formState, fileID);\n    };\n\n    _this.handleCancel = function () {\n      _this.props.toggleFileCard(false);\n    };\n\n    _this.saveOnEnter = function (ev) {\n      if (ev.keyCode === 13) {\n        ev.stopPropagation();\n        ev.preventDefault();\n        var file = _this.props.files[_this.props.fileCardFor];\n\n        _this.props.saveFileCard(_this.state.formState, file.id);\n      }\n    };\n\n    _this.renderMetaFields = function () {\n      var metaFields = _this.getMetaFields() || [];\n      var fieldCSSClasses = {\n        text: 'uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input'\n      };\n      return metaFields.map(function (field) {\n        var id = \"uppy-Dashboard-FileCard-input-\" + field.id;\n\n        var required = _this.props.requiredMetaFields.includes(field.id);\n\n        return h(\"fieldset\", {\n          key: field.id,\n          className: \"uppy-Dashboard-FileCard-fieldset\"\n        }, h(\"label\", {\n          className: \"uppy-Dashboard-FileCard-label\",\n          htmlFor: id\n        }, field.name), field.render !== undefined ? field.render({\n          value: _this.state.formState[field.id],\n          onChange: function onChange(newVal) {\n            return _this.updateMeta(newVal, field.id);\n          },\n          fieldCSSClasses: fieldCSSClasses,\n          required: required\n        }, h) : h(\"input\", {\n          className: fieldCSSClasses.text,\n          id: id,\n          type: field.type || 'text',\n          required: required,\n          value: _this.state.formState[field.id],\n          placeholder: field.placeholder,\n          onKeyUp: _this.saveOnEnter,\n          onKeyDown: _this.saveOnEnter,\n          onKeyPress: _this.saveOnEnter,\n          onInput: function onInput(ev) {\n            return _this.updateMeta(ev.target.value, field.id);\n          },\n          \"data-uppy-super-focusable\": true\n        }));\n      });\n    };\n\n    var _file = _this.props.files[_this.props.fileCardFor];\n\n    var _metaFields = _this.getMetaFields() || [];\n\n    var storedMetaData = {};\n\n    _metaFields.forEach(function (field) {\n      storedMetaData[field.id] = _file.meta[field.id] || '';\n    });\n\n    _this.state = {\n      formState: storedMetaData\n    };\n    return _this;\n  }\n\n  var _proto = FileCard.prototype;\n\n  _proto.getMetaFields = function getMetaFields() {\n    return typeof this.props.metaFields === 'function' ? this.props.metaFields(this.props.files[this.props.fileCardFor]) : this.props.metaFields;\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    var file = this.props.files[this.props.fileCardFor];\n    var showEditButton = this.props.canEditFile(file);\n    return h(\"div\", {\n      className: classNames('uppy-Dashboard-FileCard', this.props.className),\n      \"data-uppy-panelType\": \"FileCard\",\n      onDragOver: ignoreEvent,\n      onDragLeave: ignoreEvent,\n      onDrop: ignoreEvent,\n      onPaste: ignoreEvent\n    }, h(\"div\", {\n      className: \"uppy-DashboardContent-bar\"\n    }, h(\"div\", {\n      className: \"uppy-DashboardContent-title\",\n      role: \"heading\",\n      \"aria-level\": \"1\"\n    }, this.props.i18nArray('editing', {\n      file: h(\"span\", {\n        className: \"uppy-DashboardContent-titleFile\"\n      }, file.meta ? file.meta.name : file.name)\n    })), h(\"button\", {\n      className: \"uppy-DashboardContent-back\",\n      type: \"button\",\n      title: this.props.i18n('finishEditingFile'),\n      onClick: this.handleCancel\n    }, this.props.i18n('cancel'))), h(\"div\", {\n      className: \"uppy-Dashboard-FileCard-inner\"\n    }, h(\"div\", {\n      className: \"uppy-Dashboard-FileCard-preview\",\n      style: {\n        backgroundColor: getFileTypeIcon(file.type).color\n      }\n    }, h(FilePreview, {\n      file: file\n    }), showEditButton && h(\"button\", {\n      type: \"button\",\n      className: \"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit\",\n      onClick: function onClick() {\n        return _this2.props.openFileEditor(file);\n      }\n    }, this.props.i18n('editFile'))), h(\"div\", {\n      className: \"uppy-Dashboard-FileCard-info\"\n    }, this.renderMetaFields()), h(\"div\", {\n      className: \"uppy-Dashboard-FileCard-actions\"\n    }, h(\"button\", {\n      className: \"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn\" // If `form` attribute is not in Preact 8, we can’t trigger the form validation.\n      // We use a classic button with a onClick event handler.\n      ,\n      type: \"button\",\n      onClick: this.handleSave\n    }, this.props.i18n('saveChanges')), h(\"button\", {\n      className: \"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn\",\n      type: \"button\",\n      onClick: this.handleCancel\n    }, this.props.i18n('cancel')))));\n  };\n\n  return FileCard;\n}(Component);\n\nmodule.exports = FileCard;","map":{"version":3,"sources":["D:/full-version/node_modules/@uppy/dashboard/lib/components/FileCard/index.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_inheritsLoose","subClass","superClass","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_require","require","h","Component","classNames","getFileTypeIcon","ignoreEvent","FilePreview","FileCard","_Component","props","_this","updateMeta","newVal","name","_extends2","setState","formState","state","handleSave","e","preventDefault","fileID","fileCardFor","saveFileCard","handleCancel","toggleFileCard","saveOnEnter","ev","keyCode","stopPropagation","file","files","id","renderMetaFields","metaFields","getMetaFields","fieldCSSClasses","text","map","field","required","requiredMetaFields","includes","className","htmlFor","render","undefined","value","onChange","type","placeholder","onKeyUp","onKeyDown","onKeyPress","onInput","_file","_metaFields","storedMetaData","forEach","meta","_proto","_this2","showEditButton","canEditFile","onDragOver","onDragLeave","onDrop","onPaste","role","i18nArray","title","i18n","onClick","style","backgroundColor","color","openFileEditor","module","exports"],"mappings":"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","sourcesContent":["function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nvar _require = require('preact'),\n    h = _require.h,\n    Component = _require.Component;\n\nvar classNames = require('classnames');\n\nvar getFileTypeIcon = require('../../utils/getFileTypeIcon');\n\nvar ignoreEvent = require('../../utils/ignoreEvent.js');\n\nvar FilePreview = require('../FilePreview');\n\nvar FileCard = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(FileCard, _Component);\n\n  function FileCard(props) {\n    var _this;\n\n    _this = _Component.call(this, props) || this;\n\n    _this.updateMeta = function (newVal, name) {\n      var _extends2;\n\n      _this.setState({\n        formState: _extends({}, _this.state.formState, (_extends2 = {}, _extends2[name] = newVal, _extends2))\n      });\n    };\n\n    _this.handleSave = function (e) {\n      e.preventDefault();\n      var fileID = _this.props.fileCardFor;\n\n      _this.props.saveFileCard(_this.state.formState, fileID);\n    };\n\n    _this.handleCancel = function () {\n      _this.props.toggleFileCard(false);\n    };\n\n    _this.saveOnEnter = function (ev) {\n      if (ev.keyCode === 13) {\n        ev.stopPropagation();\n        ev.preventDefault();\n        var file = _this.props.files[_this.props.fileCardFor];\n\n        _this.props.saveFileCard(_this.state.formState, file.id);\n      }\n    };\n\n    _this.renderMetaFields = function () {\n      var metaFields = _this.getMetaFields() || [];\n      var fieldCSSClasses = {\n        text: 'uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input'\n      };\n      return metaFields.map(function (field) {\n        var id = \"uppy-Dashboard-FileCard-input-\" + field.id;\n\n        var required = _this.props.requiredMetaFields.includes(field.id);\n\n        return h(\"fieldset\", {\n          key: field.id,\n          className: \"uppy-Dashboard-FileCard-fieldset\"\n        }, h(\"label\", {\n          className: \"uppy-Dashboard-FileCard-label\",\n          htmlFor: id\n        }, field.name), field.render !== undefined ? field.render({\n          value: _this.state.formState[field.id],\n          onChange: function onChange(newVal) {\n            return _this.updateMeta(newVal, field.id);\n          },\n          fieldCSSClasses: fieldCSSClasses,\n          required: required\n        }, h) : h(\"input\", {\n          className: fieldCSSClasses.text,\n          id: id,\n          type: field.type || 'text',\n          required: required,\n          value: _this.state.formState[field.id],\n          placeholder: field.placeholder,\n          onKeyUp: _this.saveOnEnter,\n          onKeyDown: _this.saveOnEnter,\n          onKeyPress: _this.saveOnEnter,\n          onInput: function onInput(ev) {\n            return _this.updateMeta(ev.target.value, field.id);\n          },\n          \"data-uppy-super-focusable\": true\n        }));\n      });\n    };\n\n    var _file = _this.props.files[_this.props.fileCardFor];\n\n    var _metaFields = _this.getMetaFields() || [];\n\n    var storedMetaData = {};\n\n    _metaFields.forEach(function (field) {\n      storedMetaData[field.id] = _file.meta[field.id] || '';\n    });\n\n    _this.state = {\n      formState: storedMetaData\n    };\n    return _this;\n  }\n\n  var _proto = FileCard.prototype;\n\n  _proto.getMetaFields = function getMetaFields() {\n    return typeof this.props.metaFields === 'function' ? this.props.metaFields(this.props.files[this.props.fileCardFor]) : this.props.metaFields;\n  };\n\n  _proto.render = function render() {\n    var _this2 = this;\n\n    var file = this.props.files[this.props.fileCardFor];\n    var showEditButton = this.props.canEditFile(file);\n    return h(\"div\", {\n      className: classNames('uppy-Dashboard-FileCard', this.props.className),\n      \"data-uppy-panelType\": \"FileCard\",\n      onDragOver: ignoreEvent,\n      onDragLeave: ignoreEvent,\n      onDrop: ignoreEvent,\n      onPaste: ignoreEvent\n    }, h(\"div\", {\n      className: \"uppy-DashboardContent-bar\"\n    }, h(\"div\", {\n      className: \"uppy-DashboardContent-title\",\n      role: \"heading\",\n      \"aria-level\": \"1\"\n    }, this.props.i18nArray('editing', {\n      file: h(\"span\", {\n        className: \"uppy-DashboardContent-titleFile\"\n      }, file.meta ? file.meta.name : file.name)\n    })), h(\"button\", {\n      className: \"uppy-DashboardContent-back\",\n      type: \"button\",\n      title: this.props.i18n('finishEditingFile'),\n      onClick: this.handleCancel\n    }, this.props.i18n('cancel'))), h(\"div\", {\n      className: \"uppy-Dashboard-FileCard-inner\"\n    }, h(\"div\", {\n      className: \"uppy-Dashboard-FileCard-preview\",\n      style: {\n        backgroundColor: getFileTypeIcon(file.type).color\n      }\n    }, h(FilePreview, {\n      file: file\n    }), showEditButton && h(\"button\", {\n      type: \"button\",\n      className: \"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit\",\n      onClick: function onClick() {\n        return _this2.props.openFileEditor(file);\n      }\n    }, this.props.i18n('editFile'))), h(\"div\", {\n      className: \"uppy-Dashboard-FileCard-info\"\n    }, this.renderMetaFields()), h(\"div\", {\n      className: \"uppy-Dashboard-FileCard-actions\"\n    }, h(\"button\", {\n      className: \"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn\" // If `form` attribute is not in Preact 8, we can’t trigger the form validation.\n      // We use a classic button with a onClick event handler.\n      ,\n      type: \"button\",\n      onClick: this.handleSave\n    }, this.props.i18n('saveChanges')), h(\"button\", {\n      className: \"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn\",\n      type: \"button\",\n      onClick: this.handleCancel\n    }, this.props.i18n('cancel')))));\n  };\n\n  return FileCard;\n}(Component);\n\nmodule.exports = FileCard;"]},"metadata":{},"sourceType":"script"}