{"ast":null,"code":"import { Class, addClass, isArray, getter, deepExtend, setDefaultOptions } from '../../common';\nimport { Layer } from './layer';\nimport { Location } from '../location';\nimport { proxy, on, off, toHyphens, toPixels } from '../utils';\nvar CLICK = \"click\";\nvar MOUSE_ENTER = \"mouseenter\";\nvar MOUSE_LEAVE = \"mouseleave\";\nvar extend = Object.assign;\nvar MARKER_CLASS = \".k-marker\";\nexport var MarkerLayer = function (Layer) {\n  function MarkerLayer(map, options) {\n    Layer.call(this, map, options);\n    this._markerClickHandler = proxy(this._markerClick, this);\n    on(this.element, CLICK, MARKER_CLASS, this._markerClickHandler);\n    this.items = [];\n\n    this._load(this._readData());\n  }\n\n  if (Layer) MarkerLayer.__proto__ = Layer;\n  MarkerLayer.prototype = Object.create(Layer && Layer.prototype);\n  MarkerLayer.prototype.constructor = MarkerLayer;\n\n  MarkerLayer.prototype.destroy = function destroy() {\n    Layer.prototype.destroy.call(this);\n    off(this.element, CLICK, this._markerClickHandler);\n    this.clear();\n  };\n\n  MarkerLayer.prototype.add = function add(args) {\n    var this$1 = this;\n\n    if (isArray(args)) {\n      for (var i = 0; i < args.length; i++) {\n        this$1._addOne(args[i]);\n      }\n    } else {\n      return this._addOne(args);\n    }\n  };\n\n  MarkerLayer.prototype.remove = function remove(marker) {\n    marker.destroy();\n    var index = (this.items || []).indexOf(marker);\n\n    if (index > -1) {\n      this.items.splice(index, 1);\n    }\n  };\n\n  MarkerLayer.prototype.clear = function clear() {\n    var this$1 = this;\n\n    for (var i = 0; i < this.items.length; i++) {\n      this$1.items[i].destroy();\n    }\n\n    this.items = [];\n  };\n\n  MarkerLayer.prototype.update = function update(marker) {\n    var location = marker.location();\n\n    if (location) {\n      marker.showAt(this.map.locationToView(location));\n      var args = {\n        marker: marker,\n        layer: this\n      };\n      this.map.trigger('markerActivate', args);\n    }\n  };\n\n  MarkerLayer.prototype._reset = function _reset() {\n    var this$1 = this;\n\n    Layer.prototype._reset.call(this);\n\n    var items = this.items;\n\n    for (var i = 0; i < items.length; i++) {\n      this$1.update(items[i]);\n    }\n  };\n\n  MarkerLayer.prototype.bind = function bind(options, dataItem) {\n    var marker = Marker.create(options, this.options);\n    marker.dataItem = dataItem;\n    var args = {\n      marker: marker,\n      layer: this\n    };\n    var cancelled = this.map.trigger('markerCreated', args);\n\n    if (!cancelled) {\n      this.add(marker);\n      return marker;\n    }\n  };\n\n  MarkerLayer.prototype._addOne = function _addOne(arg) {\n    var marker = Marker.create(arg, this.options);\n    marker.addTo(this);\n    return marker;\n  };\n\n  MarkerLayer.prototype._readData = function _readData() {\n    var data = this.options.data || [];\n    return data;\n  };\n\n  MarkerLayer.prototype._load = function _load(data) {\n    var this$1 = this;\n    this._data = data;\n    this.clear();\n    var getLocation = getter(this.options.locationField);\n    var getTitle = getter(this.options.titleField);\n\n    for (var i = 0; i < data.length; i++) {\n      var dataItem = data[i];\n      this$1.bind({\n        location: getLocation(dataItem),\n        title: getTitle(dataItem)\n      }, dataItem);\n    }\n  };\n\n  MarkerLayer.prototype._markerClick = function _markerClick(e) {\n    var marker = e.target._kendoNode;\n    var args = {\n      // marker: $(e.target).data('kendoMarker'),\n      // marker: e.target.getAttribute(\"data-kendoMarker\"),\n      layer: this,\n      layerIndex: this._layerIndex(),\n      marker: marker,\n      markerIndex: (this.items || []).indexOf(marker),\n      originalEvent: e\n    };\n    this.map.trigger('markerClick', args);\n  };\n\n  MarkerLayer.prototype._markerMouseEnter = function _markerMouseEnter(e) {\n    var args = this._createMarkerEventArgs(e);\n\n    this.map.trigger(\"markerMouseEnter\", args);\n  };\n\n  MarkerLayer.prototype._markerMouseLeave = function _markerMouseLeave(e) {\n    var args = this._createMarkerEventArgs(e);\n\n    this.map.trigger(\"markerMouseLeave\", args);\n  };\n\n  MarkerLayer.prototype._createMarkerEventArgs = function _createMarkerEventArgs(e) {\n    var marker = e.marker;\n    var args = extend({}, {\n      layer: this,\n      layerIndex: this._layerIndex(),\n      marker: marker,\n      markerIndex: (this.items || []).indexOf(marker)\n    }, e);\n    return args;\n  };\n\n  return MarkerLayer;\n}(Layer);\nsetDefaultOptions(MarkerLayer, {\n  zIndex: 1000,\n  autoBind: true,\n  locationField: 'location',\n  titleField: 'title'\n});\nexport var Marker = function (Class) {\n  function Marker(options) {\n    Class.call(this);\n    this.options = options || {};\n  }\n\n  if (Class) Marker.__proto__ = Class;\n  Marker.prototype = Object.create(Class && Class.prototype);\n  Marker.prototype.constructor = Marker;\n\n  Marker.prototype.destroy = function destroy() {\n    this.layer = null;\n    this.unbindEvents();\n    this.hide();\n  };\n\n  Marker.prototype.addTo = function addTo(parent) {\n    this.layer = parent.markers || parent;\n    this.layer.items.push(this);\n    this.layer.update(this);\n  };\n\n  Marker.prototype.location = function location(value) {\n    if (value) {\n      this.options.location = Location.create(value).toArray();\n\n      if (this.layer) {\n        this.layer.update(this);\n      }\n\n      return this;\n    }\n\n    return Location.create(this.options.location);\n  };\n\n  Marker.prototype.showAt = function showAt(point) {\n    this.render();\n    this._anchor = {\n      left: Math.round(point.x),\n      top: Math.round(point.y)\n    };\n    this.element.style.left = toPixels(this._anchor.left);\n    this.element.style.top = toPixels(this._anchor.top);\n  };\n\n  Marker.prototype.hide = function hide() {\n    if (this.element) {\n      this.element.remove();\n      this.element = null;\n    }\n  };\n\n  Marker.prototype.bindEvents = function bindEvents() {\n    if (!this.element) {\n      return;\n    }\n\n    this._mouseEnterHandler = proxy(this._mouseEnter, this);\n    on(this.element, MOUSE_ENTER, MARKER_CLASS, this._mouseEnterHandler);\n    this._mouseLeaveHandler = proxy(this._mouseLeave, this);\n    on(this.element, MOUSE_LEAVE, MARKER_CLASS, this._mouseLeaveHandler);\n  };\n\n  Marker.prototype.unbindEvents = function unbindEvents() {\n    if (!this.element) {\n      return;\n    }\n\n    off(this.element, MOUSE_ENTER, this._mouseEnterHandler);\n    off(this.element, MOUSE_LEAVE, this._mouseLeaveHandler);\n  };\n\n  Marker.prototype.render = function render() {\n    if (!this.element) {\n      var options = this.options;\n      var layer = this.layer;\n      var element = document.createElement('span');\n      addClass(element, 'k-marker k-icon k-i-marker-' + toHyphens(options.shape || 'pin'));\n\n      if (options.title) {\n        element.setAttribute(\"title\", options.title);\n      }\n\n      var attributes = options.attributes || {};\n      Object.keys(attributes).forEach(function (key) {\n        element.setAttribute(key, attributes[key]);\n      });\n      element._kendoNode = this;\n      element.style.zIndex = options.zIndex;\n      this.element = element;\n\n      if (layer) {\n        layer.element.appendChild(this.element);\n      }\n\n      this.bindEvents();\n    }\n  };\n\n  Marker.prototype._mouseEnter = function _mouseEnter(e) {\n    var args = this._createEventArgs(e);\n\n    this.layer._markerMouseEnter(args);\n\n    this.layer.map._tooltip.show({\n      top: this._anchor.top - this.element.offsetHeight,\n      left: this._anchor.left\n    }, this._tooltipContext());\n  };\n\n  Marker.prototype._tooltipContext = function _tooltipContext() {\n    return {\n      type: 'marker',\n      layerIndex: this.layer._layerIndex(),\n      className: 'k-map-marker-tooltip',\n      dataItem: this.dataItem,\n      title: this.options.title,\n      location: this.location()\n    };\n  };\n\n  Marker.prototype._mouseLeave = function _mouseLeave(e) {\n    var args = this._createEventArgs(e);\n\n    this.layer._markerMouseLeave(args);\n  };\n\n  Marker.prototype._createEventArgs = function _createEventArgs(e) {\n    var args = {\n      marker: this,\n      originalEvent: e\n    };\n    return args;\n  };\n\n  Marker.create = function create(arg, defaults) {\n    if (arg instanceof Marker) {\n      return arg;\n    }\n\n    return new Marker(deepExtend({}, defaults, arg));\n  };\n\n  return Marker;\n}(Class);","map":{"version":3,"sources":["C:/Users/nsahi/OneDrive/Documents/cyber_media/cm_galaxy/node_modules/@progress/kendo-charts/dist/es/map/layers/marker.js"],"names":["Class","addClass","isArray","getter","deepExtend","setDefaultOptions","Layer","Location","proxy","on","off","toHyphens","toPixels","CLICK","MOUSE_ENTER","MOUSE_LEAVE","extend","Object","assign","MARKER_CLASS","MarkerLayer","map","options","call","_markerClickHandler","_markerClick","element","items","_load","_readData","__proto__","prototype","create","constructor","destroy","clear","add","args","this$1","i","length","_addOne","remove","marker","index","indexOf","splice","update","location","showAt","locationToView","layer","trigger","_reset","bind","dataItem","Marker","cancelled","arg","addTo","data","_data","getLocation","locationField","getTitle","titleField","title","e","target","_kendoNode","layerIndex","_layerIndex","markerIndex","originalEvent","_markerMouseEnter","_createMarkerEventArgs","_markerMouseLeave","zIndex","autoBind","unbindEvents","hide","parent","markers","push","value","toArray","point","render","_anchor","left","Math","round","x","top","y","style","bindEvents","_mouseEnterHandler","_mouseEnter","_mouseLeaveHandler","_mouseLeave","document","createElement","shape","setAttribute","attributes","keys","forEach","key","appendChild","_createEventArgs","_tooltip","show","offsetHeight","_tooltipContext","type","className","defaults"],"mappings":"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","sourcesContent":["import {\r\n    Class,\r\n    addClass,\r\n    isArray,\r\n    getter,\r\n    deepExtend,\r\n    setDefaultOptions\r\n} from '../../common';\r\n\r\nimport { Layer } from './layer';\r\nimport { Location } from '../location';\r\n\r\nimport {\r\n    proxy,\r\n    on,\r\n    off,\r\n    toHyphens,\r\n    toPixels\r\n} from '../utils';\r\n\r\nvar CLICK = \"click\";\r\nvar MOUSE_ENTER = \"mouseenter\";\r\nvar MOUSE_LEAVE = \"mouseleave\";\r\n\r\nvar extend = Object.assign;\r\nvar MARKER_CLASS = \".k-marker\";\r\n\r\nexport var MarkerLayer = (function (Layer) {\r\n    function MarkerLayer(map, options) {\r\n        Layer.call(this, map, options);\r\n\r\n        this._markerClickHandler = proxy(this._markerClick, this);\r\n        on(this.element, CLICK, MARKER_CLASS, this._markerClickHandler);\r\n\r\n        this.items = [];\r\n\r\n        this._load(this._readData());\r\n    }\r\n\r\n    if ( Layer ) MarkerLayer.__proto__ = Layer;\r\n    MarkerLayer.prototype = Object.create( Layer && Layer.prototype );\r\n    MarkerLayer.prototype.constructor = MarkerLayer;\r\n\r\n    MarkerLayer.prototype.destroy = function destroy () {\r\n        Layer.prototype.destroy.call(this);\r\n        off(this.element, CLICK, this._markerClickHandler);\r\n        this.clear();\r\n    };\r\n\r\n    MarkerLayer.prototype.add = function add (args) {\r\n        var this$1 = this;\r\n\r\n        if (isArray(args)) {\r\n            for (var i = 0; i < args.length; i++) {\r\n                this$1._addOne(args[i]);\r\n            }\r\n        } else {\r\n            return this._addOne(args);\r\n        }\r\n    };\r\n\r\n    MarkerLayer.prototype.remove = function remove (marker) {\r\n        marker.destroy();\r\n        var index = (this.items || []).indexOf(marker);\r\n\r\n        if (index > -1) {\r\n            this.items.splice(index, 1);\r\n        }\r\n    };\r\n\r\n    MarkerLayer.prototype.clear = function clear () {\r\n        var this$1 = this;\r\n\r\n        for (var i = 0; i < this.items.length; i++) {\r\n            this$1.items[i].destroy();\r\n        }\r\n\r\n        this.items = [];\r\n    };\r\n\r\n    MarkerLayer.prototype.update = function update (marker) {\r\n        var location = marker.location();\r\n\r\n        if (location) {\r\n            marker.showAt(this.map.locationToView(location));\r\n\r\n            var args = {\r\n                marker: marker,\r\n                layer: this\r\n            };\r\n\r\n            this.map.trigger('markerActivate', args);\r\n        }\r\n    };\r\n\r\n    MarkerLayer.prototype._reset = function _reset () {\r\n        var this$1 = this;\r\n\r\n        Layer.prototype._reset.call(this);\r\n\r\n        var items = this.items;\r\n\r\n        for (var i = 0; i < items.length; i++) {\r\n            this$1.update(items[i]);\r\n        }\r\n    };\r\n\r\n    MarkerLayer.prototype.bind = function bind (options, dataItem) {\r\n        var marker = Marker.create(options, this.options);\r\n        marker.dataItem = dataItem;\r\n\r\n        var args = {\r\n            marker: marker,\r\n            layer: this\r\n        };\r\n\r\n        var cancelled = this.map.trigger('markerCreated', args);\r\n\r\n        if (!cancelled) {\r\n            this.add(marker);\r\n            return marker;\r\n        }\r\n    };\r\n\r\n    MarkerLayer.prototype._addOne = function _addOne (arg) {\r\n        var marker = Marker.create(arg, this.options);\r\n        marker.addTo(this);\r\n        return marker;\r\n    };\r\n\r\n    MarkerLayer.prototype._readData = function _readData () {\r\n        var data = this.options.data || [];\r\n        return data;\r\n    };\r\n\r\n    MarkerLayer.prototype._load = function _load (data) {\r\n        var this$1 = this;\r\n\r\n        this._data = data;\r\n        this.clear();\r\n\r\n        var getLocation = getter(this.options.locationField);\r\n        var getTitle = getter(this.options.titleField);\r\n\r\n        for (var i = 0; i < data.length; i++) {\r\n            var dataItem = data[i];\r\n\r\n            this$1.bind({\r\n                location: getLocation(dataItem),\r\n                title: getTitle(dataItem)\r\n            }, dataItem);\r\n        }\r\n    };\r\n\r\n    MarkerLayer.prototype._markerClick = function _markerClick (e) {\r\n        var marker = e.target._kendoNode;\r\n\r\n        var args = {\r\n            // marker: $(e.target).data('kendoMarker'),\r\n            // marker: e.target.getAttribute(\"data-kendoMarker\"),\r\n            layer: this,\r\n            layerIndex: this._layerIndex(),\r\n            marker: marker,\r\n            markerIndex: (this.items || []).indexOf(marker),\r\n            originalEvent: e\r\n        };\r\n\r\n        this.map.trigger('markerClick', args);\r\n    };\r\n\r\n    MarkerLayer.prototype._markerMouseEnter = function _markerMouseEnter (e) {\r\n        var args = this._createMarkerEventArgs(e);\r\n        this.map.trigger(\"markerMouseEnter\", args);\r\n    };\r\n\r\n    MarkerLayer.prototype._markerMouseLeave = function _markerMouseLeave (e) {\r\n        var args = this._createMarkerEventArgs(e);\r\n        this.map.trigger(\"markerMouseLeave\", args);\r\n    };\r\n\r\n    MarkerLayer.prototype._createMarkerEventArgs = function _createMarkerEventArgs (e) {\r\n        var marker = e.marker;\r\n\r\n        var args = extend({}, {\r\n            layer: this,\r\n            layerIndex: this._layerIndex(),\r\n            marker: marker,\r\n            markerIndex: (this.items || []).indexOf(marker)\r\n        }, e);\r\n\r\n        return args;\r\n    };\r\n\r\n    return MarkerLayer;\r\n}(Layer));\r\n\r\nsetDefaultOptions(MarkerLayer, {\r\n    zIndex: 1000,\r\n    autoBind: true,\r\n    locationField: 'location',\r\n    titleField: 'title'\r\n});\r\n\r\nexport var Marker = (function (Class) {\r\n    function Marker(options) {\r\n        Class.call(this);\r\n        this.options = options || {};\r\n    }\r\n\r\n    if ( Class ) Marker.__proto__ = Class;\r\n    Marker.prototype = Object.create( Class && Class.prototype );\r\n    Marker.prototype.constructor = Marker;\r\n\r\n    Marker.prototype.destroy = function destroy () {\r\n        this.layer = null;\r\n        this.unbindEvents();\r\n        this.hide();\r\n    };\r\n\r\n    Marker.prototype.addTo = function addTo (parent) {\r\n        this.layer = parent.markers || parent;\r\n        this.layer.items.push(this);\r\n        this.layer.update(this);\r\n    };\r\n\r\n    Marker.prototype.location = function location (value) {\r\n        if (value) {\r\n            this.options.location = Location.create(value).toArray();\r\n\r\n            if (this.layer) {\r\n                this.layer.update(this);\r\n            }\r\n\r\n            return this;\r\n        }\r\n\r\n        return Location.create(this.options.location);\r\n    };\r\n\r\n    Marker.prototype.showAt = function showAt (point) {\r\n        this.render();\r\n\r\n        this._anchor = { left: Math.round(point.x), top: Math.round(point.y) };\r\n        this.element.style.left = toPixels(this._anchor.left);\r\n        this.element.style.top = toPixels(this._anchor.top);\r\n    };\r\n\r\n    Marker.prototype.hide = function hide () {\r\n        if (this.element) {\r\n            this.element.remove();\r\n            this.element = null;\r\n        }\r\n    };\r\n\r\n    Marker.prototype.bindEvents = function bindEvents () {\r\n        if (!this.element) {\r\n            return;\r\n        }\r\n\r\n        this._mouseEnterHandler = proxy(this._mouseEnter, this);\r\n        on(this.element, MOUSE_ENTER, MARKER_CLASS, this._mouseEnterHandler);\r\n        this._mouseLeaveHandler = proxy(this._mouseLeave, this);\r\n        on(this.element, MOUSE_LEAVE, MARKER_CLASS, this._mouseLeaveHandler);\r\n    };\r\n\r\n    Marker.prototype.unbindEvents = function unbindEvents () {\r\n        if (!this.element) {\r\n            return;\r\n        }\r\n\r\n        off(this.element, MOUSE_ENTER, this._mouseEnterHandler);\r\n        off(this.element, MOUSE_LEAVE, this._mouseLeaveHandler);\r\n    };\r\n\r\n    Marker.prototype.render = function render () {\r\n        if (!this.element) {\r\n            var options = this.options;\r\n            var layer = this.layer;\r\n\r\n            var element = document.createElement('span');\r\n            addClass(element, 'k-marker k-icon k-i-marker-' + toHyphens(options.shape || 'pin'));\r\n\r\n            if (options.title) {\r\n                element.setAttribute(\"title\", options.title);\r\n            }\r\n\r\n            var attributes = options.attributes || {};\r\n            Object.keys(attributes).forEach(function(key) {\r\n                element.setAttribute(key, attributes[key]);\r\n            });\r\n\r\n            element._kendoNode = this;\r\n            element.style.zIndex = options.zIndex;\r\n\r\n            this.element = element;\r\n\r\n            if (layer) {\r\n                layer.element.appendChild(this.element);\r\n            }\r\n\r\n            this.bindEvents();\r\n        }\r\n    };\r\n\r\n    Marker.prototype._mouseEnter = function _mouseEnter (e) {\r\n        var args = this._createEventArgs(e);\r\n        this.layer._markerMouseEnter(args);\r\n\r\n        this.layer.map._tooltip.show({\r\n            top: this._anchor.top - this.element.offsetHeight,\r\n            left: this._anchor.left\r\n        }, this._tooltipContext());\r\n    };\r\n\r\n    Marker.prototype._tooltipContext = function _tooltipContext () {\r\n        return {\r\n            type: 'marker',\r\n            layerIndex: this.layer._layerIndex(),\r\n            className: 'k-map-marker-tooltip',\r\n            dataItem: this.dataItem,\r\n            title: this.options.title,\r\n            location: this.location()\r\n        };\r\n    };\r\n\r\n    Marker.prototype._mouseLeave = function _mouseLeave (e) {\r\n        var args = this._createEventArgs(e);\r\n        this.layer._markerMouseLeave(args);\r\n    };\r\n\r\n    Marker.prototype._createEventArgs = function _createEventArgs (e) {\r\n        var args = {\r\n            marker: this,\r\n            originalEvent: e\r\n        };\r\n\r\n        return args;\r\n    };\r\n\r\n    Marker.create = function create (arg, defaults) {\r\n        if (arg instanceof Marker) {\r\n            return arg;\r\n        }\r\n\r\n        return new Marker(deepExtend({}, defaults, arg));\r\n    };\r\n\r\n    return Marker;\r\n}(Class));\r\n"]},"metadata":{},"sourceType":"module"}